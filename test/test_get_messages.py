from gpgclip.gpg_messages import get_pubkeys, get_encrypted_messages, get_signed_messages

PUBKEY = '''
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBF8QOPEBCADDXiDS4m/73gUu/21N5sn1zKXLbVXwbPS3150U8s+HueNXyozi
bfvpgmKVM3sqvQtfixbHhefR6QuChZ3KjB/GzVLZhf/nOvRdrClNbPy2RZbS1IHy
eQhySY7MPhMDCMf1xyTI4sRNHHJTqFwKbKYDXwjJrmqowXRrhs9rPOmRNjXA2OVV
OQHXe/meR184tjf9Sv4DOgRU8OKrJAhHlRWIksiLwY0WrJ/KNjogpco1uYfFi/Sq
7Hzq83mAa1Hbpbucn0HKpCtsPlAzx6EE0zgxs1qPzOUBEU1eTpDZ0WPolrDUtzTe
b4pacT4aziuTdxij6kjvqdy3DWEbn/WIXQJ7ABEBAAG0G1NhbXBsZSBrZXkgPHNh
bXBsZUBrZXkuY29tPokBVAQTAQgAPhYhBO+XhwozgpNWc7wzHIvWDKhGUUOjBQJf
EDjxAhsDBQkDwmcABQsJCAcCBhUKCQgLAgQWAgMBAh4BAheAAAoJEIvWDKhGUUOj
ifYH/1F7XRtweftKJG5rk/rXEmUqSoKszcZZm3jdJ9/RBaQIv5pkWXP2yaYnDpMB
ovH4qJoC0su+XrIoeA3m5HlbVmDbvFubRH4ARRbHOGE7a7iDsQzLRTxovgN33Fhm
k1A0p/crSVlAyDCD9CzPOm1L/ehDmuVh4Gvx5MkXSS5hcTZcX4Z0P5JgnFbgaUJC
lmn2Fgqo0+/zz4Nxhw8gFJftqgyvqioHYthimUzEBhmvdaXB75W42+T20/LXRD+M
zv+/xu+p9gBdt4z13xbOETd7TBx2DYQp7zHJ6bDL6gf45ABvHWQ7krY6PTYdzGjL
yOM/8sZztyTc2IxZw8PLdYgDDMi5AQ0EXxA48QEIAMVY23K4Ez18EaruMCzl6+zq
V++d67MHd3t1I+VxXrp0zzRUGoWQ6lwsGzZuTp80EddIzsjYRiFssS9/qBpipJZY
La+GSZvL+K9FKSHOGIe5ixrlB35A7sZAA5fDGvCUgwW9OKe0ceiskVMSUY+5wIKJ
i8DzEEQB+xIF/nGhVt+zx4zZPUwBRi+hrGCti2LFR0YSyPpv1TB5/0w0TR4HB/fq
vyHo4LRC5pmMQyzk4+MxGXmUDs0Dy+OeOPy3lQL1/u9k+id3vl3Z6/EzxnnEmg36
ccXG9sBn3timHhwv2iBnzOzO63i759lI2YV/lIgZLzwZhUP5xxEBs8KhxPejsXcA
EQEAAYkBPAQYAQgAJhYhBO+XhwozgpNWc7wzHIvWDKhGUUOjBQJfEDjxAhsMBQkD
wmcAAAoJEIvWDKhGUUOjYssIAIwIcsSuVHVDxcvrWH7KOPvBi81zWeUH14fNVmYr
pmBnrYpjVikTQuYG4AdKhfruBL7cMIk6QvYBPP1ZdLMem4IeM9bbfihXK5tnjTSr
9gzuZW6MM+x4RvEFlEpQAGhVs504opRG53UtbHLKAL+JGqwKdRc0f6RPbgGmgZZX
bkQiR4hpPl7Os5RPpGickmrs6cUiwO1uUz9I7vFU7wsc5h9xQWysi33mZa0pg93A
4pb+zSMF7N0TbFAIHyTaYY1KWn3Qa/kPyiwsDo1Mp/oWkyyWcwsk2zrTkf8F0b+V
J+CiqdoDa978NQPoQVqKwOeTnSj80Cw6nTXTwilRY/73nsc=
=NAGt
-----END PGP PUBLIC KEY BLOCK-----

'''


ENCRYPTED_MESSAGE = '''
-----BEGIN PGP MESSAGE-----

hQEMA9tgm3IbHbnUAQf9Fbw4i34pD1gsbzRu0a74OOXgxogMTyQE2BEhiAROd1LG
JlR9f5KDiYHYPySyns3o2l+UVV/xQjDSQ22jby55/wX+JfO+7wlYX+6odp6vRlFK
IX0rgQBrZhvkqrZx1ptJ0QZHMdgMu+3P4inFDAHqVGRGNr7QN8L5jYOaDOZTDpju
eMpf2PNAkSf2K96oGFw1EsXfJXoqBBZplwHJQVNEU8l7VZwMUWWsq9ZtboA0Ajs7
NImumq2hS61e1EFsG/pEebSnYNcV3yyp47nh6EFsi4HBe/sAVaYsvrzRnK4G4cC/
eO2Okt9VS4kiWNTCs/C+z8znWka6u5Fpdntk2F9JvtJOAaKmfPl5iRdi7JXzfl7/
mHoscYFGGucUeOg+OlGWpEa6LwjM6wOASS6RqCC6wePVZDJbGAZG/e1V7HdgP7vH
WkIu7zRjXy7JJm+XW2hF
=P9ja
-----END PGP MESSAGE-----
'''


SIGNED_MESSAGE = '''
-----BEGIN PGP SIGNATURE-----

iQEzBAABCAAdFiEE75eHCjOCk1ZzvDMci9YMqEZRQ6MFAl8QO7sACgkQi9YMqEZR
Q6OncwgAlLN6folJHAe65Mtx4ZmnufXKpyRyAPd/Gtsfg4BYthS2vIk6J5M63q9O
flI8bf+m20nkHb8fTiYqUvxO5JAqcXAiw6kI7OCxTg7YQhWX4Gic7YVqFpZcyEwA
ZeaGB1C3jEcQI9k4QPizMAbUa0hpncOZ6pC5WgYJ5wU7mwtaU/WlQ3A0GT9eW36k
9+CF8xs9NAltRU0/wpLMsoWdnkP9wqy0mJ2KenRH5PxRtAgpKYYTFlQsB1VljxSW
kifzIVwHiShUcDzCu/S2HdjCUz90OuWJUlElxPylLiEQBOi0Hu9+C0qT1Ntn7B6T
rE9hGaRF/A26V3Wiu1RYL3/oQFscag==
=HRPL
-----END PGP SIGNATURE-----
'''


def test_get_pubkeys():
    pubkeys = get_pubkeys(PUBKEY)
    assert pubkeys[0] == PUBKEY.strip()


def test_get_encryped_messages():
    messages = get_encrypted_messages(ENCRYPTED_MESSAGE)
    assert messages[0] == ENCRYPTED_MESSAGE.strip()


def test_get_signed_messages():
    messages = get_signed_messages(SIGNED_MESSAGE)
    assert messages[0] == SIGNED_MESSAGE.strip()
